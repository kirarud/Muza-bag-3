
<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Nexus: Singularity Protocol (Stable)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      // Инициализация глобальных переменных до загрузки модулей
      window.process = { env: { API_KEY: "" } };
      window.__NEXUS_SUPERVISOR__ = {
        integrity: 100,
        failures: [],
        status: 'BOOTING',
        bootTimestamp: Date.now()
      };

      // Глобальный перехватчик для ранней диагностики
      window.addEventListener('error', function(e) {
        console.error('BOOT_CRITICAL_ERROR:', e.error);
        if (document.getElementById('root')?.innerHTML === '') {
           document.body.innerHTML = `
            <div style="background:#020617;color:#f87171;padding:2rem;font-family:monospace;height:100vh;display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center;">
              <h1 style="border-bottom:1px solid #f87171;padding-bottom:1rem;font-size:1.5rem;">FATAL SYSTEM FAILURE</h1>
              <p>Ошибка инициализации модулей. Конфликт зависимостей.</p>
              <pre style="background:#000;padding:1rem;margin-top:1rem;overflow:auto;max-width:80vw;text-align:left;color:#ef4444;">${e.message}</pre>
              <button onclick="localStorage.clear();location.reload();" style="background:#f87171;color:#000;border:none;padding:0.75rem 1.5rem;cursor:pointer;margin-top:2rem;font-weight:bold;text-transform:uppercase;">Сброс к заводским настройкам</button>
            </div>
           `;
        }
      });
    </script>
    <style>
      body { background-color: #020617; color: #f8fafc; margin: 0; overflow: hidden; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }
      #root { height: 100vh; width: 100vw; }
      .bg-scanlines {
        background: linear-gradient(to bottom, transparent 50%, rgba(0,0,0,0.1) 50%);
        background-size: 100% 4px;
        pointer-events: none;
      }
    </style>
    <script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@18.2.0?bundle",
    "react-dom": "https://esm.sh/react-dom@18.2.0?bundle",
    "react-dom/client": "https://esm.sh/react-dom@18.2.0/client?bundle",
    "react/jsx-runtime": "https://esm.sh/react@18.2.0/jsx-runtime?bundle",
    "@google/genai": "https://esm.sh/@google/genai@0.1.2",
    "react-dom/": "https://esm.sh/react-dom@^19.2.4/",
    "react/": "https://esm.sh/react@^19.2.4/"
  }
}
</script>
  </head>
  <body>
    <div id="root"></div>
    <div class="fixed inset-0 bg-scanlines z-[9999]"></div>
    <script type="module" src="./index.tsx"></script>
  </body>
</html>
